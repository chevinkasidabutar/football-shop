{% load static %}

<article class="card-float bg-white/90 border border-purple-100 rounded-xl shadow-sm hover:shadow-md transition p-3">
  <!-- klik card membuka modal detail via :target -->
  <a href="#p{{ product.id }}-detail" class="block">
    <div class="relative w-full aspect-[4/3] overflow-hidden rounded-lg mb-3">
      {% if product.thumbnail %}
        <img src="{{ product.thumbnail }}" class="w-full h-full object-cover" alt="{{ product.name|default:'Product' }}">
      {% else %}
        <img src="{% static 'image/no-name.JPG' %}" class="w-full h-full object-contain p-6" alt="Product">
      {% endif %}
    </div>

    <h3 class="font-bold text-gray-900 mb-1 line-clamp-2">{{ product.name }}</h3>
    <p class="text-gray-600 text-sm line-clamp-3">{{ product.description|striptags|truncatewords:20 }}</p>
  </a>

  {% if user.is_authenticated and product.user == user %}
  <div class="mt-3 flex justify-end gap-2">
    <!-- tombol edit buka modal edit (tetap flip) -->
    <a href="#p{{ product.id }}-edit" class="px-3 py-1.5 text-xs border rounded-lg hover:bg-gray-50">Edit</a>

    <form method="post" action="{% url 'main:delete_product' product.id %}" onsubmit="return confirm('Hapus produk ini?')">
      {% csrf_token %}
      <button type="submit" class="px-3 py-1.5 text-xs border border-red-200 text-red-600 rounded-lg hover:bg-red-50">Delete</button>
    </form>
  </div>
  {% endif %}
</article>
